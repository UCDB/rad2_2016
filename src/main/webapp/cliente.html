<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cadastro de Cliente</title>


<script src="js/jquery-3.1.0.min.js"></script>

<script>
$(document).ready(function (){
		
	carregarClientes();

	//jquery
	
	$("#btSalvar").click(function (){

		txtNome = $("#txtNome").val();
		txtEmail = $("#txtEmail").val();
		
		$.ajax({
				url:'clientes',
				type:'POST',
				dataType:'json',
				contentType:'application/json;charset=UTF-8',
				data:JSON.stringify({nome:txtNome,email:txtEmail}),
				success:function(){
					window.alert("Salvo com Sucesso!");
					carregarClientes();
				}
			});
	
	});	
});

function excluir (id){
	if (window.confirm('Tem certeza que deseja excluir?')){
		$.ajax({
				url:'clientes/'+id,
				type:'DELETE',
				success:function(){
					window.alert("Excluido com Sucesso!");
					carregarClientes();
				}
			});
	}
}

//Nativo
function carregarClientes(){
	conteudo.innerHTML ="";
	
	$.get("clientes", function (objDados, status){

		conteudo = document.getElementById("conteudo");

		for (i=0; i<objDados.length ; i++){
			
			conteudo.innerHTML += objDados[i].id+ "| "  + objDados[i].nome + " | " + objDados[i].email ;
			conteudo.innerHTML += "<button onclick='excluir("+ objDados[i].id+")'>excluir</button><br>"			
	
			}
		
	});
}

</script>
</head>
<body>

<h1> Cadastro de Cliente</h1>
<form>
	<label>Nome:</label>
	<input type="text" id="txtNome"/>
	
	<label>E-mail:</label>
	<input type="text" id="txtEmail"/>
	
	<input type="button" id="btSalvar" value="Salvar"/>
	
	
</form>

	<div id="conteudo">
	
	</div>
	
	


</body>
</html>